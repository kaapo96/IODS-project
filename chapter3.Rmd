# Analysis of alcohol consumption data (Week 3)

In this Analysis exercise, ...

## Loading data

I start by loading the alcohol consumption data set with the `read_csv` function from the `readr` library and print the name of its variables:

```{r}
# load the readr library
library(readr)

# load the data file
alc <- read_csv("data/alc.csv")

# print the variable names
colnames(alc)

```

The data of 370 observations is combined from two data sets describing student achievement in secondary education of two Portuguese schools (https://archive.ics.uci.edu/dataset/320/student+performance). The data attributes include student grades, demographic, social and school related features and it was collected by using school reports and questionnaires. This analysis studies students' alcohol consumption, which is described by four variables in the data:

- `Dalc`: Workday alcohol consumption (numeric: from 1 - very low to 5 - very high)
- `Walc`: Weekend alcohol consumption (numeric: from 1 - very low to 5 - very high)
- `alc_use`: Average of `Dalc` and `Walc`
- `high_use`: `TRUE` if `alc_use > 2` and `FALSE` otherwise

In this report, I will mostly focus on the last variable and its relationship with some of the other variables in the data set.

## Four variables vs. alcohol consumption

Next, I will choose four interesting variables and hypothesize about their relationship with high/low alcohol consumption. The variables and hypotheses are:

- `activities`: Extra-curricular activities (binary: yes or no). My guess is that students with extra-curricular activities have less time to consume alcohol.
- `freetime`: Free time after school (numeric: from 1 - very low to 5 - very high). My prediction is that the amount of free time a student has correlates with the alcohol consumption.
- `famrel`: Quality of family relationships (numeric: from 1 - very bad to 5 - excellent). I hypothesize that this variable has an anti-correlation with alcohol use: a high quality of family relationship promotes less drinking and vice versa.
- `studytime`: Weekly study time (numeric: 1 - <2 hours, 2 - 2 to 5 hours, 3 - 5 to 10 hours, or 4 - >10 hours). For this one, I also assume an anti-correlation: students who study more are less likely to have time and/or motivation to go out and drink.

Let's study numerically and graphically the distributions of the chosen variables and see if the hypotheses hold. First, it is useful to check the distributions of each variable of interest:

```{r}

# access the tidyverse libraries tidyr, dplyr, ggplot2
library(tidyr); library(dplyr); library(ggplot2)

# draw a bar plot of each variable
select(alc, all_of(c("high_use","activities","freetime","famrel","studytime"))) %>% gather %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()

```



```{r}
# Cross tabulation of high alcohol use and activities
table(alc$high_use, alc$activities)

# Cross tabulation of high alcohol use and free time
table(alc$high_use, alc$freetime)

# Cross tabulation of high alcohol use and family relations
table(alc$high_use, alc$famrel)

# Cross tabulation of high alcohol use and study time
table(alc$high_use, alc$studytime)

```


```{r}

# Plot high_use vs. activities
ggplot(data = alc, aes(x = high_use)) + geom_bar() + facet_wrap("activities")


```






